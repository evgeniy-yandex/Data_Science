# Яндекс Практикум. Курс "Data Science". Проект "Отток клиентов из банка".

# 1  Описание проекта:
Из «Бета-Банка» стали уходить Клиенты. Каждый месяц. Немного, но заметно.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком.

Постройте модель с предельно большим значением F1-меры. Чтобы сдать проект успешно, нужно довести метрику до 0.59. Проверьте F1-меру на тестовой выборке самостоятельно.

Дополнительно измеряйте AUC-ROC, сравнивайте её значение с F1-мерой.

# 2  Цели проекта:
Провести исследование с целью построения прогноза: уйдёт Клиент из банка или останется.

Результаты исследования позволят специалистам сохранить текущих Клиентов, т.к. это дешевле, чем привлекать новых.

# 3  Задачи проекта:
Загрузить и подготовить данные. Пояснить порядок действий.
Исследовать баланс классов, обучить модель без учёта дисбаланса. Кратко описать выводы.
Улучшить качество модели, учитывая дисбаланс классов. Обучить разные модели и найти лучшую. Кратко описать выводы.
Провести финальное тестирование.

# 4  Проверяемые гипотезы:
Гипотеза 1: самый высокий результат предсказания метрики F1-мера на валидационной выборке будет давать модель случайного леса;
Гипотеза 2: значение метрики F1-мера наилучшей модели больше 0.59;
Гипотеза 3: значение метрики AUC-ROC повышается с ростом значения F1-меры;
Гипотеза 4: лучшая модель чаще ошибается, прогнозируя Клиентов, которые ушли из банка.

# 5  Описание данных:
Получены исторические данные о поведении Клиентов и расторжении договоров с банком. Данные находятся в файле Churn.csv (англ. «отток Клиентов»).

Источник данных: https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling

# 6. Общий вывод
По результатам исследования можно отметить следующие факты и сделать следующие выводы:

1.Проведено исследование с целью построения модели прогноза: "Уйдет Клиент из банка или останется".

2.Модель построена на основании поведения клиентов, ушедших из банка или оставшихся в нем.

3.Были построены 3 модели:

'дерево решений' ( `Decision Tree Classifier` ),
'случайный лес' ( `RandomForestClassifier` ),
'логистическая регрессия' ( `Logistic Regression` ).
4.В целевом признаке есть сильный дисбаланс классов «1» или «0» — только 20% значений отражают факт ухода Клиента из банка.

5.Обучены все три модель без учёта дисбаланса. Согласно значению `'f1-score'` и `'матрице ошибок'` лучшие модели: `'дерево решений'` и `'случайный лес'`.

6.Для всех трех моделей применены 3 метода борьбы с дисбалансом классов:

`'Взвешивание классов'`.
`'Увеличение выборки (upsampling)'`.
`'Уменьшение выборки (downsampling)'`.
7.Наилучшей признана модель `'случайный лес'` с методом `'Взвешивание классов'`, построенная при значениях: `max_depth = 8`, `n_estimators = 289`.

8.Для тестовой выборки с наилучшей моделью получили следующие значения метрик:

Значение `'f1-score'` равно `0.61`, что выше целевого показателя в `0.59`.
Значение `'ROC AUC:'` составляет `0.867`.
Все это на уровне значений, полученных на валидационной выборке для лучших моделей.
9.Проверка на адекватность проведена на модели `DummyClassifier`. Полученное значение `'f1-score'` равно `0.32`, что ниже, чем у выбранной нами лучшей модели (`0.61`), значит наша модель адекватна и эффективна.

10.Значение метрики `'AUC-ROC'` всегда выше `'f1-score'`. Для модели `'случайный лес'` оно всегда выше `0.85`, а для модели `'дерево решений'` выше `0.83`.
