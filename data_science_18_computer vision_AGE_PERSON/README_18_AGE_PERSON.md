# Яндекс Практикум. Курс "Data Science". Проект "Определение возраста покупателей по фото".

# 1  Задание на проект.

## 1.1. Описание проекта:
Сетевой супермаркет «Хлеб-Соль» внедряет систему компьютерного зрения для обработки фотографий покупателей. Фотофиксация в прикассовой зоне поможет определять возраст клиентов, чтобы:

* анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы;
* контролировать добросовестность кассиров при продаже алкоголя.
Задача - построить модель, которая по фотографии определит приблизительный возраст человека. Для работы предоставлен набор фотографий людей с указанием возраста.

## 1.2. Инструкция по выполнению проекта:

1. Провести исследовательский анализ набора фотографий.
2. Подготовить данные к обучению.
3. Обучить нейронную сеть и рассчитайте её качество.

## 1.3. Описание данных:

Данные взяты с сайта `ChaLearn Looking at People`. Они находятся в папке `/datasets/faces/`.

В нашем распоряжении одна папка со всеми изображениями (`/final_files`) и CSV-файл `labels.csv` с двумя колонками: `file_name` и `real_age`.

Извлечь данные из папки поможет метод ImageDataGenerator — `flow_from_dataframe(dataframe, directory, ...)`.


# 2 Исследовательский анализ данных

## Задание 1:

Провести исследовательский анализ данных:

* посмотреть на размер выборки.
* построить график распределения возраста в выборке.
* напечатать на экране 10–15 фотографий и посмотреть, как устроен датасет.

Сделать выводы о том, как результаты исследования повлияют на обучение модели.

## Выводы по разделу 'Исследовательский анализ данных'.

По результатам исследовательского анализа данных отмечаем следующее:

1. Неравномерное распределение людей по возрасту.
2. Размер фотографий одинаков для всего датасета.
3. Для решения задачи оценки возраста человека следует воспользоваться линейной регрессией.
4. Модель должна выдавать только одно число, соответствующее рассчитанному возрасту человека.
5. На выходе модели требуется всего один нейрон, который вернёт возраст человека.
6. В связи с тем, что на выходе нейронной сети находится один нейрон, в качестве функции активации используем ReLU. Положительные прогнозы такая функция не меняет, а все отрицательные зануляет. Чисел, соответствующих отрицательному возрасту, не может быть.
7. Под задачу регрессии в качестве метрики потерь выберем MAE.


## 3 Обучение модели

## Задание 2:

* Обучить модель в GPU-тренажёре и сохранить результат вывода модели на экран.
* Добиться значения `MAE` на тестовой выборке не больше `8`.

## Выводы по разделу 'Обучение модели'.

1. Построена и обучена свёрточная нейронная сеть ResNet50 глубиной в 50 слоев на датасете с фотографиями людей.
2. Полученное значение `'MAE'` на тестовой выборке равно `5.7`, что ниже требуемого значения `8`.


# 4 Общие выводы.

1. Проведено исследование с целью построения нейронной сети, которая поможет определить по фотографии приблизительный возраст человека.
2. В результате создана и обучена модель, для которой можно получить значение метрики `mae = 5.7` на тестовой выборке, что ниже требуемого по условию проекта значения 8.
3. Сетевому супермаркету «Хлеб-Соль» можно рекомендовать использовать полученную модель, как систему компьютерного зрения для обработки фотографий покупателей.