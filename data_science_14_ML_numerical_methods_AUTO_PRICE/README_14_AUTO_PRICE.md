# Яндекс Практикум. Курс "Data Science". Проект "Определение стоимости автомобилей".

# 1  Описание проекта:

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля. В вашем распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей. Вам нужно построить модель для определения стоимости.

Заказчику важны:

* качество предсказания;
* скорость предсказания;
* время обучения.

## 1.1. Описание данных.

В нашем распоряжении информация с техническими характеристиками и стоимостью автомобилей.

*Признаки*:

* `DateCrawled` — дата скачивания анкеты из базы
* `VehicleType` — тип автомобильного кузова
* `RegistrationYear` — год регистрации автомобиля
* `Gearbox` — тип коробки передач
* `Power` — мощность (л. с.)
* `Model` — модель автомобиля
* `Kilometer` — пробег (км)
* `RegistrationMonth` — месяц регистрации автомобиля
* `FuelType` — тип топлива
* `Brand` — марка автомобиля
* `Repaired` — была машина в ремонте или нет
* `DateCreated` — дата создания анкеты
* `NumberOfPictures` — количество фотографий автомобиля
* `PostalCode` — почтовый индекс владельца анкеты (пользователя)
* `LastSeen` — дата последней активности пользователя

Целевой признак:

* `Price` — цена (евро)

## 1.2. План работы.

1. Загружаем данные их файла *autos.csv*.
2. Изучаем данные. Заполняем пропущенные значения и обработаем аномалии в признаках. Если среди признаков имеются неинформативные, удалим их.
3. Готовим выборки для обучения моделей.
4. Обучаем разные модели, одна из которых — LightGBM, как минимум одна — не бустинг. Для каждой модели пробуем разные гиперпараметры.
5. Анализируем время обучения, время предсказания и качество моделей.
6. Опираясь на критерии заказчика, выбираем лучшую модель, проверяем её качество на тестовой выборке.

## 1.3. Инструкция по выполнению проекта.

Чтобы усилить исследование, не ограничивайтесь градиентным бустингом. Попробуйте более простые модели — иногда они работают лучше. Эти редкие случаи легко пропустить, если всегда применять только бустинг.

Поэкспериментируйте и сравните характеристики моделей: время обучения, время предсказания, точность результата.

**Примечания**:

* Для оценки качества моделей применяйте метрику `RMSE`.
* Значение метрики `RMSE` должно быть меньше `2500`.
* Самостоятельно освойте библиотеку `LightGBM` и её средствами постройте модели градиентного бустинга.
* Время выполнения ячейки кода Jupyter Notebook можно получить специальной командой. Найдите её.
* Модель градиентного бустинга может долго обучаться, поэтому измените у неё только два-три параметра.
* Если перестанет работать Jupyter Notebook, удалите лишние переменные оператором del. Пример: del features_train.

# 2 Общие выводы.

1.Проведено исследование с целью построения оптимальной модели машинного обучения, для определения рыночной стоимости автомобиля.

* Результаты исследования позволят сервису по продаже автомобилей разработать приложение для привлечения новых клиентов.
* Входные данные: исторические данные - технические характеристики, комплектации и цены автомобилей.

2.Для подготовки данных к последующей обработке были проведены следующие операции:

* Загрузка локального и удаленного файла с данными.
* Выяснили, что объем данных довольно большой: 354 369 строк х 16 столбцов.
* Названия столбцов откорректированы и приведены к стилю `snake_case`.
* Дубликаты в количестве 4 штуки исключены.
* Удалены неинформативные признаки.
* Изучены количественные признаки. Аномальные значения удалены.
* Проверены категориальные признаки. Пустые значения заполнены.
* Проведено кодирование категориальных принаков (перевод в численные).
* Выполнено масштабирование численных признаков.
* Проверка количества оставшихся после всех сокращений данных. Сохранено более 90% данных.

3.Созданы и обучены следующие модели:

* Линейная регрессия.
* Случайного дерева `'Decision Tree'` с подбором глубины дерева.
* 'Cлучайного леса' c подбором гиперпараметров методом `GridSearchCV`.
* `GradientBoostingRegressor`.
* Градиентного бустинга `LightGBM`.
* Градиентного бустинга `LightGBM` с функций `GridSearchCV`.
* Градиентного бустинга `CatBoost`.
* Градиентного бустинга `CatBoost` + `GridSearchCV`.
* Градиентного бустинга `XGBoost`.
* Градиентного бустинга `XGBoost` + `G0ridSearchCV`.

Все они имеют значение `RSME` ниже контрольной величины `2500`.

4.Самыми важными для всех моделей являются 2 признака:

* `registration_year` — год регистрации автомобиля.
* `power` — мощность (л. с.).

5.Проверка модели на адекватность выполнена на константной модели. Полученное значение ошибки выше, чем на любой из рабочей модели.

6.Наилучшей по параметрам 'качество - время создания и обучения' является модель `‘XGBRegressor’`:

* Значение `RSME` равно `1814`.
* Время обучения 1.3 секунды.
* Лучшая модель имеет следующие гиперпараметры: `'learning_rate' = 0.15`, `'max_depth' = 8`, `'n_estimators' = 10`, `'random_state' = 12345`.

7.Рассмотрены зависимости `RSME` от гиперпараметров на примере лучшей модели.

8.Специалистам сервиса по продаже автомобилей можно рекомендовать использовать модель `‘XGBRegressor’`.
